\subsection{Performance Evaluation}
\label{sec:evaluation}

\begin{figure*}[tb]  % 星号*表示跨双栏
  \centering
    \renewcommand{\thesubfigure}{\roman{subfigure}} % 改为罗马数字
  % 第一行：横向两个子图
  \subfigure[\footnotesize Initial visit]{
    \begin{minipage}[b]{0.9\columnwidth}
      \includegraphics[width=\linewidth]{fig/evaluation-nocache-internet.pdf}
    \end{minipage}
  }\hfill
  \subfigure[\footnotesize Subsequent visit]{
    \begin{minipage}[b]{0.9\columnwidth}
      \includegraphics[width=\linewidth]{fig/evaluation-cache-internet.pdf}
    \end{minipage}
  }
  \vspace*{-10pt}
  \par\medskip
  \centering{\footnotesize (a) With a remotely-visiting browser}

    \setcounter{subfigure}{0} % 重置subfigure计数器
  % 第二行：横向两个子图
  \subfigure[\footnotesize Initial visit]{
    \begin{minipage}[b]{0.9\columnwidth}
      \includegraphics[width=\linewidth]{fig/evaluation-nocache-LAN.pdf}
    \end{minipage}
  }\hfill
  \subfigure[\footnotesize Subsequent visit]{
    \begin{minipage}[b]{0.9\columnwidth}
      \includegraphics[width=\linewidth]{fig/evaluation-cache-LAN.pdf}
    \end{minipage}
  }
  \vspace*{-10pt}
  \par\medskip
  \centering{\footnotesize (b) In a local virtual environment}

  
  \vspace*{-5pt}
  \caption{The time costs of SSO login in MITREid Connect, UPPRESSO, and SPRESSO}
  \label{fig:evaluation}
\end{figure*} 

\noindent {\bf Experiment setting.}
%SPRESSO encrypts the RP's domain in identity tokens and keeps the AES symmetric key known only to the RP and the user.
We conducted experiments in two settings: (\emph{a}) on a PC with Core AMD Ryzen 7 57000x CPU and 32 GB memory, the browser ran locally, and the IdP and RP servers and the extra forwarder server of SPRESSO were deployed on the separated virtual machines, each of which ran Windows 10 with 2 vCPUs and 4GB RAM, and (\emph{b}) the browser running locally on the PC with Core AMD Ryzen 7 57000x CPU and 32 GB memory, remotely accessed the servers (IdP and RP servers, and the extra forwarder server of SPRESSO) were all deployed on the Alibaba Cloud Elastic Compute Service, each of which ran Windows 10 with 8 vCPUs and 32GB RAM. 
The deployment of services on the same PC (setting a) minimized the impact of network delays.

%Of all solutions, the IdP and RP servers and the extra forwarder server of SPRESSO were all deployed on the Alibaba Cloud Elastic Compute Service, each of which ran Windows 10 with 8 vCPUs and 32GB RAM.

%We conducted experiments in two settings: (\emph{a}) a browser, Chrome 138.0.7204.158, ran on a virtual machine on the cloud platform with 8 vCPUs and 32 GB memory, and (\emph{b}) the browser running locally on a PC with Core i7-8700 CPU and 32 GB memory, remotely accessed the servers. All entities except the local browser, were deployed in the same virtual private cloud and connected to one vSwitch, which minimized the impact of network delays.
%In both settings, the IdP server never directly communicated with RPs.


\noindent {\bf Comparisons.} We split the login flow into three phases for detailed comparisons: (1)
{\em identity-token requesting} (Step 1 in Figure \ref{fig:process}), to construct an identity-token request and send it to the IdP server; (2) {\em identity-token generation} (Step 2 of UPPRESSO), to generate an identity token at the IdP server, while the user authentication and the user-attribute authorization are excluded; and (3) {\em identity-token acceptance} (Step 3), where the RP receives, verifies, and parses the identity token.


%\begin{figure}[tb]
 % \centering
%	\subfigure[In a virtual private cloud]{
%  		\begin{minipage}[b]{0.45\textwidth}
%			\includegraphics[width=0.97\linewidth]{fig/evaluation-lan.pdf}
%		\end{minipage}}
%	\subfigure[With a remotely-visiting browser]{
%  		\begin{minipage}[b]{0.45\textwidth}
%			\includegraphics[width=0.97\linewidth]{fig/evaluation-internet.pdf}
%		\end{minipage}}
%  \caption{The time costs of SSO login in MITREid Connect, UPPRESSO, and SPRESSO}
%  \label{fig:evaluation}
%\end{figure}

Of all solutions, the IdP, RP, and SPRESSO extra forwarder servers require user-side scripts, which introduces additional time overhead for downloading. 
In the identity-token requesting phase of UPPRESSO a browser downloads the two scripts,
    as described in Section \ref{sec:web-design}.
As mentioned in Section \ref{subsec:OIDC},
 to process the token retrieved from the IdP, %which is carried with a URL following the fragment identifier \texttt{\#} instead of \texttt{?} due to security considerations \cite{de2014oauth},
    in MITREid Connect and SPRESSO a user-r script is downloaded during the phase of token generation.
SPRESSO needs another script from the forwarder server in the token acceptance phase \cite{SPRESSO}.
However, once a browser visits the server, it can cache these scripts locally, reducing download time for subsequent visits. 

Therefore, we measured the time cost for both initial and subsequent visits (1,000 trials each) and compared the average SSO login times across the three schemes. As shown in Figure \ref{fig:evaluation},
MITREid Connect, UPPRESSO, and SPRESSO require (\emph{a}) 70 ms, 190 ms, and 280 ms for initial visits, and 65 ms, 152 ms and 278 ms for subsequent visits,
 or (\emph{b}) 224 ms, 321 ms, and 670 ms for initial visits, and 65 ms, 152 ms and 635 ms for subsequent visits.

Regarding identity-token requesting, %the user browser loads the RP's webpage and starts the login request.
the RP of MITREid Connect immediately constructs an identity-token request. %MITREid Connect only needs 10 ms but UPPRESSO requires 271 ms.
UPPRESSO incurs overheads in opening a new browser window and downloading the scripts.
%
%\footnote{This pop-up overhead can be reduced %by silently conducting these operations when the user visits the RP website, or
%by browser extensions.
%We have implemented such a browser extension while keeping the IdP and RPs unmodified, and the supplementary experiments showed a reduction of (\emph{a}) about 90 ms in the virtual private cloud setting and (\emph{b}) 260 ms when accessed remotely.}
%
In SPRESSO the RP also needs to open a new browser window, and obtain information about the IdP % 's public key %(SPRESSO allows a user to assign any IdPs before login without initial registrations)
and encrypt its domain using an ephemeral key, resulting in extra overheads.

UPPRESSO requires the least time for generating identity tokens for it receives the token from the IdP without any additional processing.
MITREid Connect and SPRESSO require extra time as the browser downloads a script from the RP (FWD server) in this phase. % to process the token retrieved from the IdP, which is carried with a URL following the fragment identifier \texttt{#} instead of \texttt{?} due to security considerations \cite{de2014oauth}.
Moreover, SPRESSO takes slightly more time to generate an identity token, as it implements the IdP using node.js and uses a JavaScript cryptographic library that is a little less efficient than the Java library used in the others.

In the identity-token acceptance phase, 
MITREid Connect and UPPRESSO take similar amounts of time for the RP to receive a token and accept it.
In contrast, SPRESSO takes the longest time due to its complex processing at the user agent.
After receiving an identity token from the IdP, the browser downloads another script from the forwarder server, to decrypt the RP redirection endpoint and sends the token to this endpoint.
